/* =========================================================
   iWork STYLE - Versione 17 (Consolidata & Ottimizzata)
   ========================================================= */

:root {
    --blue: #007AFF;
    --red: #FF3B30;
    --green: #34C759;
    --orange: #FF9500;
    --bg: #F2F2F7;
    --card-bg: #FFFFFF;
    --line: rgba(0, 0, 0, 0.1);
}

/* Modalit√† Dark Glass (Automatica e Forzata per Calendario) */
@media (prefers-color-scheme: dark) {
    :root {
        --bg: #0B0B0D;
        --card-bg: #1C1C1E;
        --line: rgba(255, 255, 255, 0.15);
    }
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background: var(--bg);
    margin: 0;
    padding-top: env(safe-area-inset-top);
    padding-bottom: calc(100px + env(safe-area-inset-bottom));
    color: #000;
    -webkit-tap-highlight-color: transparent;
    transition: background 0.3s ease;
}

@media (prefers-color-scheme: dark) {
    body { color: #FFF; }
}

/* =========================================================
   NAVBAR & BRAND (Patch v17 Compact)
   ========================================================= */
.ios-navbar {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    padding: calc(22px + env(safe-area-inset-top)) 16px 10px !important;
    border-bottom: 0.5px solid var(--line);
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
}

.nav-brand {
    font-size: 22px !important;
    font-weight: 800 !important;
    letter-spacing: -0.4px;
}

@media (prefers-color-scheme: dark) {
    .ios-navbar {
        background: rgba(20, 20, 22, 0.85);
        border-bottom: 0.5px solid rgba(255, 255, 255, 0.1);
    }
}

/* =========================================================
   LAYOUT & CARDS
   ========================================================= */
.main-content { padding: 16px; }

.dashboard-header { padding-bottom: 20px; }
.date-subtitle { font-size: 13px; text-transform: uppercase; color: #8E8E93; margin: 0; font-weight: 600; }
.large-title { font-size: 34px; font-weight: 700; margin: 4px 0 0; }

.ios-card-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 20px;
}

.ios-card {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.02);
    display: flex;
    flex-direction: column;
}

.card-label { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
.ios-card .value { font-size: 24px; font-weight: 700; }
.ios-card .subvalue { font-size: 11px; color: #8E8E93; margin-top: 4px; }

/* Pulsanti stile iOS */
.ios-card-btn {
    width: 100%;
    background: var(--card-bg);
    border: none;
    border-radius: 12px;
    padding: 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 16px;
    margin-bottom: 10px;
    cursor: pointer;
    color: inherit;
}

/* =========================================================
   TAB BAR (Liquid Glass v17)
   ========================================================= */
.tab-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: calc(65px + env(safe-area-inset-bottom));
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    display: flex;
    justify-content: space-around;
    padding-bottom: env(safe-area-inset-bottom);
    border-top: 0.5px solid var(--line);
    z-index: 1000;
}

.tab-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: #8E8E93;
    font-size: 10px;
    gap: 4px;
    position: relative;
    z-index: 2;
    transition: color 0.3s;
}

.tab-item.active { color: var(--blue); }
.tab-item span { font-weight: 500; }

/* Indicatore Liquido */
.liquid-indicator {
    position: absolute;
    top: 8px;
    height: 44px;
    width: 65px;
    background: rgba(0, 122, 255, 0.15);
    border-radius: 20px;
    z-index: 1;
    transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1.1);
}

@media (prefers-color-scheme: dark) {
    .tab-bar { background: rgba(28, 28, 30, 0.85); border-top: 0.5px solid rgba(255,255,255,0.1); }
    .liquid-indicator { background: rgba(255, 255, 255, 0.12); }
}

/* =========================================================
   CALENDARIO (Design Black Glass)
   ========================================================= */
body[data-page="calendario"] {
    background: #0B0B0D !important;
    color: #FFF !important;
}

body[data-page="calendario"] .calendar-wrapper {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    overflow-x: auto;
}

.grid-table { width: 100%; border-collapse: collapse; table-layout: fixed; }
.grid-table th, .grid-table td {
    border: 0.5px solid rgba(255, 255, 255, 0.1);
    height: 45px;
    text-align: center;
    font-size: 11px;
}

/* Colori Mesi e Giorni */
.col-mese { 
    background: rgba(255, 255, 255, 0.07) !important; 
    font-weight: 700; 
    position: sticky; left: 0; z-index: 10;
}

/* Classi Dinamiche Calendario */
.bg-sabato { background: rgba(255, 255, 255, 0.05); }
.bg-domenica { background: rgba(142, 142, 147, 0.4); color: #FFF; }
.bg-festivo { background: var(--red) !important; color: #FFF; }
.bg-ferie { background: var(--green) !important; color: #FFF; }
.bg-ferie-az { background: var(--orange) !important; color: #FFF; }
.bg-malattia { background: #AF52DE !important; color: #FFF; }
.bg-avis { background: var(--blue) !important; color: #FFF; }

.is-pian {
    outline: 2px dashed rgba(255, 255, 255, 0.6);
    outline-offset: -3px;
}

/* =========================================================
   MODALI & INPUT (iOS Style)
   ========================================================= */
.ios-page-sheet {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: var(--card-bg);
    border-radius: 20px 20px 0 0;
    z-index: 2000;
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    display: flex; flex-direction: column;
}

.ios-page-sheet.active { transform: translateY(0); }

.modal-nav {
    padding: 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 0.5px solid var(--line);
}

.btn-link { background: none; border: none; font-size: 17px; color: var(--blue); cursor: pointer; }

.ios-input-group {
    background: var(--card-bg);
    margin: 20px;
    border-radius: 12px;
    overflow: hidden;
}

.ios-input-row {
    padding: 12px 16px;
    display: flex;
    align-items: center;
    border-bottom: 0.5px solid var(--line);
}

.ios-input-row label { width: 100px; font-size: 15px; }
.ios-input-row input, .ios-input-row select {
    flex: 1; border: none; background: none; font-size: 16px; color: inherit; outline: none;
}

/* FAB Button */
.ios-fab {
    position: fixed;
    right: 20px;
    bottom: calc(85px + env(safe-area-inset-bottom));
    width: 56px; height: 56px;
    background: var(--blue);
    border-radius: 50%;
    border: none;
    color: white;
    font-size: 32px;
    box-shadow: 0 4px 12px rgba(0, 122, 255, 0.4);
    z-index: 90;
}